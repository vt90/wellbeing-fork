<ion-header>
    <ion-toolbar>
        <ion-buttons slot="start">
            <ion-menu-button></ion-menu-button>
        </ion-buttons>
        <ion-title>
            WellBeing
        </ion-title>
        <ion-buttons class="lang-buttons ion-hide-md-down" slot="primary">
            <app-langselect></app-langselect>
        </ion-buttons>
    </ion-toolbar>
</ion-header>
<ion-content>
    <ion-row>
        <ion-col size="2" class="vertical-menu" style="width: 100%; height: 100%">
            Left Navigation
        </ion-col>
        <ion-col size="10">
            <ion-row>
                <ion-col class="ion-float-left">
                    <ion-title>Clinic/ Hospital Details</ion-title>
                </ion-col>
                <ion-col (click)="newClinic()" class="ion-float-right"
                         style="text-decoration: underline;color:blue">
                    + Add clinic / hospital details
                </ion-col>
            </ion-row>
            <ion-row *ngIf="clinics">
                <ion-col size="4">
                    <ion-title><strong>Name</strong></ion-title>
                </ion-col>
                <ion-col size="4">
                    <ion-title><strong>Address</strong></ion-title>
                </ion-col>
            </ion-row>
            <ion-row *ngFor="let c of clinics; let i=index;">
                <ion-col size="4">{{c.name}}</ion-col>
                <ion-col size="4">{{c.addressLine1 }},{{c.city}}</ion-col>
                <ion-col size="2">
                    <ion-label style="text-decoration: underline;color: blue;padding-right: 5%" (click)="editClinic(c)">
                        Edit
                    </ion-label>
                    <ion-label style="text-decoration: underline;color: red" (click)="deleteClinic(c.clinicId)">Delete
                    </ion-label>
                </ion-col>
            </ion-row>


            <form #clinicForm="ngForm" (ngSubmit)="save(clinicForm)">
                <div *ngIf="clinicSetup">
                    <!--CLINIC BLOCK-->
                    <ion-row style="background-color: #048bc1; font-size: larger">
                        <ion-col class="subBlocks">
                            <ion-label><strong> Clinic/Hospital Details </strong></ion-label>
                            <ion-icon *ngIf="!showClinic" (click)="showClinic = true"
                                      name="add-circle-sharp"></ion-icon>
                            <ion-icon *ngIf="showClinic" (click)="showClinic = false"
                                      name="remove-circle-sharp"></ion-icon>
                        </ion-col>
                    </ion-row>

                    <ion-row *ngIf="showClinic">
                        <ion-col class="subBlocks">

                            <ion-item>
                                <ion-label class="asterisk"><strong>Clinic Name</strong></ion-label>
                                <ion-input type="text"
                                           required
                                           name="cName"
                                           ngModel
                                           pattern="[a-zA-Z0-9 ]*"
                                           placeholder="Clinic or Hospital Name"
                                           [(ngModel)]="clinic.name"
                                           #nameCtrl="ngModel">
                                </ion-input>
                            </ion-item>
                            <ion-item *ngIf="nameCtrl.invalid && (nameCtrl.touched || nameCtrl.dirty)"
                                      lines="none">
                                <ion-item *ngIf="nameCtrl.errors.required">
                                    <ion-label color="danger"> Clinic Name required</ion-label>
                                </ion-item>
                                <ion-item *ngIf="nameCtrl.hasError('pattern')">
                                    <ion-label color="danger"> clinic name is invalid</ion-label>
                                </ion-item>
                            </ion-item>
                            <ion-item>
                                <ion-label class="asterisk"><strong>Address line 1</strong></ion-label>
                                <ion-input type="text"
                                           ngModel
                                           required
                                           name="address1"
                                           placeholder="address line 1"
                                           [(ngModel)]="clinic.addressLine1"
                                           #address1Ctrl="ngModel">
                                </ion-input>
                            </ion-item>
                            <ion-item *ngIf="address1Ctrl.invalid && (address1Ctrl.touched || address1Ctrl.dirty)"
                                      lines="none">
                                <ion-item *ngIf="address1Ctrl.errors.required">
                                    <ion-label color="danger">Address Line 1 required</ion-label>
                                </ion-item>
                            </ion-item>

                            <ion-item>
                                <ion-label class="asterisk"><strong>Address line 2</strong></ion-label>
                                <ion-input type="text"
                                           ngModel
                                           required
                                           name="address2"
                                           placeholder="address line 2"
                                           [(ngModel)]="clinic.addressLine2"
                                           #address2Ctrl="ngModel">
                                </ion-input>
                            </ion-item>
                            <ion-item *ngIf="address2Ctrl.invalid && (address2Ctrl.touched || address2Ctrl.dirty)"
                                      lines="none">
                                <ion-item *ngIf="address2Ctrl.errors.required">
                                    <ion-label color="danger">Address Line 1 required</ion-label>
                                </ion-item>
                            </ion-item>

                            <ion-item>
                                <ion-label class="asterisk"><strong>City</strong></ion-label>
                                <ion-input type="text"
                                           ngModel
                                           required
                                           name="city"
                                           placeholder="City"
                                           pattern="[a-zA-Z ]*"
                                           [(ngModel)]="clinic.city"
                                           #cityCtrl="ngModel">
                                </ion-input>
                            </ion-item>
                            <ion-item *ngIf="cityCtrl.invalid && (cityCtrl.touched || cityCtrl.dirty)"
                                      lines="none">
                                <ion-item *ngIf="cityCtrl.errors.required">
                                    <ion-label color="danger"> city required</ion-label>
                                </ion-item>
                                <ion-item *ngIf="cityCtrl.hasError('pattern')">
                                    <ion-label color="danger"> City is invalid</ion-label>
                                </ion-item>
                            </ion-item>

                            <ion-item>
                                <ion-label class="asterisk"><strong>State/Province/Region</strong></ion-label>
                                <ion-input type="text"
                                           ngModel
                                           required
                                           name="state"
                                           placeholder="State"
                                           pattern="[a-zA-Z ]*"
                                           [(ngModel)]="clinic.state"
                                           #stateCtrl="ngModel">
                                </ion-input>
                            </ion-item>
                            <ion-item *ngIf="stateCtrl.invalid && (stateCtrl.touched || stateCtrl.dirty)"
                                      lines="none">
                                <ion-item *ngIf="stateCtrl.errors.required">
                                    <ion-label color="danger"> State required</ion-label>
                                </ion-item>
                                <ion-item *ngIf="stateCtrl.hasError('pattern')">
                                    <ion-label color="danger"> State is invalid</ion-label>
                                </ion-item>
                            </ion-item>

                            <ion-item>
                                <ion-label class="asterisk"><strong>Zip/Postal code</strong></ion-label>
                                <ion-input type="number"
                                           placeholder="Zip Code"
                                           ngModel
                                           required
                                           name="code"
                                           [(ngModel)]="clinic.zipcode"
                                           pattern="[0-9]{6}" #zipCtrl="ngModel">
                                </ion-input>
                            </ion-item>
                            <ion-item *ngIf="zipCtrl.hasError('pattern')">
                                <ion-label color="danger">enter 6 digit zip code</ion-label>
                            </ion-item>

                            <ion-item>
                                <ion-label class="asterisk"><strong>Country</strong></ion-label>
                                <ion-input type="text"
                                           placeholder="Country"
                                           ngModel
                                           required
                                           name="country"
                                           pattern="[a-zA-Z ]*"
                                           [(ngModel)]="clinic.country"
                                           #countryCtrl="ngModel">
                                </ion-input>
                            </ion-item>
                            <ion-item *ngIf="countryCtrl.invalid && (countryCtrl.touched || countryCtrl.dirty)"
                                      lines="none">
                                <ion-item *ngIf="countryCtrl.errors.required">
                                    <ion-label color="danger"> Country required</ion-label>
                                </ion-item>
                                <ion-item *ngIf="countryCtrl.hasError('pattern')">
                                    <ion-label color="danger"> Country is invalid</ion-label>
                                </ion-item>
                            </ion-item>

                        </ion-col>
                    </ion-row>

                    <!--AVAILABILITY BLOCK-->
                    <ion-row style="background-color: #048bc1; font-size: larger">
                        <ion-col class="subBlocks">
                            <ion-label><strong>Availability</strong></ion-label>
                            <ion-icon *ngIf="!showAvail" (click)="showAvail = true" name="add-circle-sharp"></ion-icon>
                            <ion-icon *ngIf="showAvail" (click)="showAvail = false"
                                      name="remove-circle-sharp"></ion-icon>
                        </ion-col>
                    </ion-row>

                    <ion-row *ngIf="showAvail">
                        <ion-col class="subBlocks">
                            <form #scheduleForm="ngForm" (ngSubmit)="addSchedule()">
                                <ion-label><strong>Add multiple Schedule </strong></ion-label>
                                <ion-item>
                                    <ion-label class="asterisk"><strong>Days</strong></ion-label>
                                </ion-item>
                                <ion-label *ngFor="let d of days">{{d.val}}
                                    <ion-checkbox slot="end" name="days" [(ngModel)]="d.isChecked">
                                    </ion-checkbox>
                                </ion-label>


                                <ion-item>
                                    <ion-label class="asterisk"><strong>Slot per Patient</strong></ion-label>
                                </ion-item>
                                <ion-label *ngFor="let s of slots">{{s.val}} mins
                                    <ion-checkbox slot="end" name="slot" [(ngModel)]="s.isChecked"
                                                  (click)="timeSlotSelection(s.val)">
                                    </ion-checkbox>
                                </ion-label>

                                <ion-item>
                                    <ion-label><strong>Shift Timing</strong></ion-label>
                                </ion-item>
                                <ion-item>
                                    <ion-label class="asterisk"><strong>From</strong></ion-label>
                                    <ion-datetime displayFormat="HH:mm"
                                                  placeholder="from"
                                                  name="from"
                                                  ngModel required
                                                  minuteValues="0,15,30,45"
                                                  [(ngModel)]="fromTime">
                                    </ion-datetime>
                                    <ion-label class="asterisk"><strong>To</strong></ion-label>
                                    <ion-datetime displayFormat="HH:mm"
                                                  placeholder="to"
                                                  name="to"
                                                  ngModel required
                                                  minuteValues="0,15,30,45"
                                                  [(ngModel)]="toTime">
                                    </ion-datetime>
                                </ion-item>
                                <ion-item>
                                    <ion-button type="submit" [disabled]="scheduleForm.invalid">Add Schedule
                                    </ion-button>
                                </ion-item>

                                <ion-item *ngIf="clinic.schedules.length !== 0">
                                    <ion-row style="width:100%">
                                        <ion-label><strong>Added Schedule</strong></ion-label>
                                    </ion-row>
                                </ion-item>
                                <ion-item *ngFor="let sc of clinic.schedules; let i = index">
                                    <ion-row style="background-color:#4c8dff;width:100%">
                                        <ion-col size="6">
                                            {{sc.availableDays}}
                                        </ion-col>
                                        <ion-col size="3">
                                            {{sc.fromTime  }} To {{ sc.toTime}}
                                        </ion-col>
                                        <ion-col size="auto">
                                            <ion-icon name="remove-circle-sharp"
                                                      (click)="clinic.schedules.splice(i,1)"></ion-icon>
                                        </ion-col>
                                    </ion-row>
                                </ion-item>
                            </form>
                        </ion-col>
                    </ion-row>

                    <!--FEE BLOCK-->
                    <ion-row style="background-color: #048bc1; font-size: larger">
                        <ion-col class="subBlocks">
                            <ion-label><strong>Fee Structure</strong></ion-label>
                            <ion-icon *ngIf="!showFee" (click)="showFee = true" name="add-circle-sharp"></ion-icon>
                            <ion-icon *ngIf="showFee" (click)="showFee = false" name="remove-circle-sharp"></ion-icon>
                        </ion-col>
                    </ion-row>

                    <ion-row *ngIf="showFee">
                        <ion-col class="subBlocks">
                            <ion-item>
                                <ion-label><strong>Consultation Fee</strong></ion-label>
                                <ion-input type="number"
                                           name="cFee"
                                           placeholder="Consultation Fee"
                                           [(ngModel)]="clinic.fee.cFee">
                                </ion-input>
                            </ion-item>

                            <ion-item>
                                <ion-label><strong>Follow up Fee</strong></ion-label>
                                <ion-input type="number"
                                           name="fFee"
                                           placeholder="Follow up fee"
                                           [(ngModel)]="clinic.fee.fFee">
                                </ion-input>
                            </ion-item>
                        </ion-col>
                    </ion-row>
                </div>

                <div *ngIf="clinicSetup" class="btn-container">
                    <ion-button *ngIf="!editClinicData" type="submit" [disabled]="clinicForm.invalid">Save</ion-button>
                    <ion-button *ngIf="editClinicData" type="submit" [disabled]="clinicForm.invalid">Update</ion-button>
                    <ion-button (click)="clinicSetup = false">Cancel</ion-button>
                </div>
            </form>
        </ion-col>
    </ion-row>
</ion-content>
